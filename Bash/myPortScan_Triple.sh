#!/bin/bash
# # # Port Discovery Scanner # # #
# nmap TCP ALL
# nmap UDP top 500
# rustscan ALL

# If ran with Sudo
if [ "$EUID" -ne 0 ]
   then echo "$(tput setaf 3)Please run as root"
   exit
fi

# If arg != 1 Print Usage
if [ -z "$1" ]
   then
   echo "$(tput setaf 3)Usage: sudo bash myRecon.sh x.x.x.x"
   exit
fi


# 1. Nmap TCP all ports
echo -e "$(tput setaf 5)\n\n[+](1/3) nmap $1 -sT -p-"
echo "$(tput setaf 7)"
nmap $1 -sT -p-

# 2. Nmap UDP top 500 ports
echo -e "$(tput setaf 5)\n\n[+](2/3) nmap $1 -sU --top-ports 500"
echo "$(tput setaf 7)"
nmap $1 -sU --top-ports 500

# 3a. Docker Start
echo -e "$(tput setaf 5)\n\n[+] starting docker"
echo "$(tput setaf 7)"
systemctl start docker

# 3b.Rustscan scan all ports
echo -e "$(tput setaf 5)\n\n[+](3/3) docker run -it --rm --name rustscan rustscan -a $1 -- -sV"
echo "$(tput setaf 7)"
docker run -it --rm --name rustscan rustscan -a $1 -- -sV

# 3c. Docker Stop
echo -e "$(tput setaf 5)\n\n[+] stopping docker"
echo "$(tput setaf 7)"
systemctl stop docker

echo -e "$(tput setaf 5)\n\nService Scan:   nmap $1 -p<ports here> -sV -vv --open --reason"

