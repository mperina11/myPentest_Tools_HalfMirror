#include <unistd.h>
#include <sys/mman.h>

#define SCSSIZE 43

unsigned char PAYLOAD[SCSSIZE] = 
"\xeb\x17\x31\xc0\xb0\x04\x31\xdb\xb3\x01\x59\x31\xd2\xb2\x0d\xcd\x80\x31\xc0\xb0\x01\x31\xdb\xcd\x80\xe8\xe4\xff\xff\xff\x48\x65\x6c\x6c\x6f\x20\x57\x6f\x72\x6c\x64\x21\x0a";

int main(void) {
	// create executable memory
	mprotect((void*)((intptr_t)PAYLOAD & ~0xFFF), SCSSIZE, PROT_READ|PROT_EXEC);
	int (*exeshell)() = (int (*)()) PAYLOAD;
	(int)(*exeshell)(); // execute shellcode

	return 0;
}
